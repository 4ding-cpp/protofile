syntax = "proto3";

package ding4;

option go_package = "github.com/4ding-cp/4dingsite/ptypes/m4g";

import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";

message Response {
    uint32 code = 1;
    string message = 2;
    string insert_id = 3;
    int64 affect_row = 4;
    PageLimit pageLimit = 5;
    repeated Sort sort = 6;
    repeated Condition condition = 7;
    google.protobuf.Value result = 8;
}

message DBMessage {
    int64 insert_id = 1;
    int64 affect_row = 2;
}

message PageLimit {
    int64 length = 1;
    int64 page_index = 2;
    int64 page_size = 3;
}

message Sort {
    bool desc = 1;
    string f = 2;
}

message Condition {
    string f = 1;
    string v = 2;
    repeated string s = 3;
    enum Operand {
        UNIVERSAL = 0;
        LT = 1;
        LTE = 2;
        GT = 3;
        GTE = 4;
        IN = 5;
        LIKE = 6;
        LABEL = 7;
        UNLABEL = 8;
        LEVEL = 9;
        CLASS = 10;
    }
    Operand o = 4;
}

message Query {
    PageLimit page_limit = 1;
    repeated Sort sort = 2;
    repeated Condition condition = 3;
    repeated string extra = 4;
    google.protobuf.Struct self = 5;
};

message SignRecord {
    int32 user_id = 1;
    string account = 2;
    string type = 3;
    string os = 4;
    string browser = 5;
    int32 created = 6;
    google.protobuf.Timestamp online_at = 7;
    google.protobuf.Timestamp offline_at = 8;
}

message Result {
    PageLimit page_limit = 1;
    repeated Sort sort = 2;
    google.protobuf.Value result = 3;
}